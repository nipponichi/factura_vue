import{s as x}from"./dialog.esm-VmiGjN6p.js";import{a as _,c as C,s as M}from"./column.esm-B0kMEs2H.js";import{s as S}from"./toolbar.esm-mLzmTsQ_.js";import{i as T,j as g,o as d,e as f,a,b as i,w as k,c as m,f as b,t as o,k as h,v as y,m as N,x as U,g as $}from"./app-CEnNdpTV.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={data(){return{banks:null,bankDialog:!1,deleteBankDialog:!1,deleteBanksDialog:!1,myBank:{id:"",iban:"",entity:"",office:"",control_digit:"",account_number:"",bank_name:"",country:"",swift:"",currency:"",favourite:"",complete_bank_account:"",companyID:window.location.pathname.split("/").pop()},originalBanks:{},selectedBanks:[],filters:{},submitted:!1}},created(){this.filters={global:{value:null,matchMode:T.CONTAINS}}},mounted(){this.fetchBanks()},methods:{fetchBanks(){let e=window.location.pathname.split("/").pop();g.get("/banks/"+e).then(t=>{this.banks=t.data.accounts}).catch(t=>{this.$toast(this.$t("Error connecting to the server"),"error")})},openNew(){this.myBank={bank:"",companyID:window.location.pathname.split("/").pop()},this.submitted=!1,this.bankDialog=!0},hideDialog(){this.bankDialog=!1,this.submitted=!1},saveMyBank(){this.myBank.favourite==null&&(this.myBank.favourite=!1);let e=this.myBank.complete_bank_account.replace(/\s+/g,"");if(e.length==24){let u=e.substring(0,2).toUpperCase(),w=e.substring(2,4),s=u+w,l=e.substring(4,8),r=e.substring(8,12),p=e.substring(12,14),c=e.substring(14,24);this.myBank.iban=s,this.myBank.entity=l,this.myBank.office=r,this.myBank.control_digit=p,this.myBank.account_number=c,this.myBank.complete_bank_account=s+" "+l+" "+r+" "+p+" "+c}let t=e.length;switch(!0){case t>24:this.$toast(this.$t("The account number entered is too long."),"warning");break;case t<24:this.$toast(this.$t("The account number entered is too short."),"warning");break;case t==24:this.myBank.id?this.updateMyBank():g.post("/bank",this.myBank).then(u=>{this.$toast(this.$t(u.data.message),u.data.type),this.fetchBanks(),this.bankDialog=!1}).catch(u=>{this.$toast(this.$t("Error connecting to the server"),"error"),this.bankDialog=!1});break}},editMyBank(e){this.originalBank={...e},this.myBank.id=e.id,this.myBank.complete_bank_account=e.complete_bank_account,this.myBank.bank_name=e.bank_name,this.myBank.country=e.country,this.myBank.swift=e.swift,this.myBank.currency=e.currency,this.myBank.favourite=e.favourite,this.bankDialog=!0},updateMyBank(){if(this.originalBank.companyID=this.myBank.companyID,JSON.stringify(this.originalBank)===JSON.stringify(this.myBank)){this.$toast(this.$t("Successfully updated."),"success"),this.bankDialog=!1;return}g.put("/bank/"+this.myBank.id,this.myBank).then(e=>{this.$toast(this.$t(e.data.message),e.data.type),this.fetchBanks(),this.bankDialog=!1}).catch(e=>{this.$toast(this.$t("Error connecting to the server"),"error"),this.bankDialog=!1})},makeFavourite(e){if(e.favourite)return this.$toast(this.$t("Already selected as a favorite."),"warning");g.put("/banks/"+e.id).then(t=>{this.$toast(this.$t(t.data.message),t.data.type),this.bankDialog=!1,this.fetchBanks()}).catch(t=>{this.$toast(this.$t("Error connecting to the server"),"error"),this.bankDialog=!1})},confirmDeleteBank(e){this.myBank=e,this.deleteBankDialog=!0},deleteMyBank(){const e=this.myBank.id;g.delete("/bank/"+this.myBank.id).then(t=>{t.data.type==="success"&&(this.banks=this.banks.filter(u=>u.id!==e)),this.$toast(this.$t(t.data.message),t.data.type)}).catch(t=>{this.$toast(this.$t(t.response.message),t.response.type)}),this.deleteBankDialog=!1},confirmDeleteSelected(){this.deleteBanksDialog=!0},deleteSelectedBanks(){this.selectedBanks.forEach(e=>{g.delete("/bank/"+e.id).then(t=>{t.data.type==="success"&&(this.banks=this.banks.filter(u=>u.id!==e.id)),this.$toast(this.$t(t.data.message),t.data.type)}).catch(t=>{(t.response||t.response.status===400)&&this.$toast(this.$t(t.response.message),t.response.type)})}),this.deleteBanksDialog=!1}}},E={class:"card"},V={class:"flex justify-between items-center mt-2"},F={class:"relative rounded-md shadow-sm w-1/4"},R=["placeholder"],L=a("div",{class:"absolute inset-y-0 left-0 flex items-center pl-3"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[a("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1),q={class:"utility-button"},z={class:"grid gap-3 mb-6 md:grid-cols-1"},O={for:"iban",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},Z=["placeholder"],j={for:"bank_name",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},W=["placeholder"],J={for:"country",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},P=["placeholder"],Y={for:"swift",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},K=["placeholder"],G={for:"currency",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},H=["placeholder"],Q={key:0,class:"flex items-center"},X={for:"favourite-checkbox",class:"ms-2 text-sm font-medium text-gray-900 dark:text-gray-300"},ee={class:"grid gap-3 md:grid-cols-1 justify-items-end"},te={type:"submit",class:"text-white bg-blue-600 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"},ae={class:"confirmation-content"},se=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),ne={key:0},le={class:"confirmation-content"},ie=a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),re={key:0};function oe(e,t,u,w,s,l){const r=C,p=S,c=M,D=_,B=x;return d(),f("div",null,[a("div",E,[i(p,{class:"mb-4 border border-slate-200 ..."},{start:k(()=>[e.$page.props.user.permissions.includes("create bank account")?(d(),m(r,{key:0,label:e.$t("New"),icon:"pi pi-plus",severity:"success",class:"mr-2 success-button",onClick:l.openNew},null,8,["label","onClick"])):b("",!0),e.$page.props.user.permissions.includes("delete bank account")?(d(),m(r,{key:1,label:e.$t("Delete"),icon:"pi pi-trash",severity:"danger",class:"danger-button",onClick:l.confirmDeleteSelected,disabled:!s.selectedBanks||!s.selectedBanks.length},null,8,["label","onClick","disabled"])):b("",!0)]),_:1}),i(D,{ref:"dt",value:s.banks,selection:s.selectedBanks,"onUpdate:selection":t[1]||(t[1]=n=>s.selectedBanks=n),dataKey:"id",onRowSelect:e.onRowSelect,paginator:!0,rows:10,filters:s.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,25],currentPageReportTemplate:`${e.$t("Showing")} {first} ${e.$t("of")} {last} ${e.$t("of")} {totalRecords} ${e.$t("Banks accounts")}`},{header:k(()=>[a("div",V,[a("h4",null,o(e.$t("Manage Bank account")),1),a("div",F,[h(a("input",{type:"search",class:"block w-full h-11 rounded-md border-0 py-1.5 pl-10 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm","onUpdate:modelValue":t[0]||(t[0]=n=>s.filters.global.value=n),placeholder:e.$t("Search...")},null,8,R),[[y,s.filters.global.value]]),L])])]),default:k(()=>[i(c,{selectionMode:"multiple",exportable:!1,class:"datetable checkbox w-16"}),i(c,{field:"complete_bank_account",header:e.$t("Bank account"),sortable:"",class:"dateTable"},null,8,["header"]),i(c,{field:"bank_name",header:e.$t("Bank name"),sortable:"",class:"dateTable"},null,8,["header"]),i(c,{field:"swift",header:e.$t("SWIFT"),sortable:"",class:"dateTable"},null,8,["header"]),i(c,{field:"currency",header:e.$t("Currency"),sortable:"",class:"dateTable"},null,8,["header"]),e.$page.props.user.permissions.includes("update bank account")?(d(),m(c,{key:0,exportable:!1,header:e.$t("Favourite"),class:"dateTable w-24 text-center"},{body:k(n=>[n.data.favourite?(d(),m(r,{key:0,icon:"pi pi-star-fill",class:"mr-2 fav-button",onClick:v=>l.makeFavourite(n.data)},null,8,["onClick"])):(d(),m(r,{key:1,icon:"pi pi-star",class:"mr-2 fav-button",onClick:v=>l.makeFavourite(n.data)},null,8,["onClick"]))]),_:1},8,["header"])):b("",!0),a("div",q,[i(c,{exportable:!1,header:e.$t("Utilities"),class:"headerUtil dateTable w-24"},{body:k(n=>[e.$page.props.user.permissions.includes("update bank account")?(d(),m(r,{key:0,icon:"pi pi-pencil",outlined:"",rounded:"",class:"mr-2 edit-button",onClick:v=>l.editMyBank(n.data)},null,8,["onClick"])):b("",!0),e.$page.props.user.permissions.includes("delete bank account")?(d(),m(r,{key:1,icon:"pi pi-trash",outlined:"",rounded:"",class:"simpleDelete-button",severity:"danger",onClick:v=>l.confirmDeleteBank(n.data)},null,8,["onClick"])):b("",!0)]),_:1},8,["header"])])]),_:1},8,["value","selection","onRowSelect","filters","currentPageReportTemplate"])]),a("template",null,[i(B,{visible:s.bankDialog,"onUpdate:visible":t[10]||(t[10]=n=>s.bankDialog=n),header:s.myBank.id?e.$t("Update bank"):e.$t("Add bank"),id:"titleBank",modal:!0,class:"p-fluid"},{default:k(()=>[a("form",{style:{width:"800px"},onSubmit:t[9]||(t[9]=N((...n)=>l.saveMyBank&&l.saveMyBank(...n),["prevent"]))},[a("div",z,[a("div",null,[a("label",O,o(e.$t("IBAN")),1),h(a("input",{type:"text",id:"complete_bank_account","onUpdate:modelValue":t[2]||(t[2]=n=>s.myBank.complete_bank_account=n),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:e.$t("ES12 3456 7890 90 1234567890"),pattern:"[A-Za-z]{2}[0-9\\s]*",required:""},null,8,Z),[[y,s.myBank.complete_bank_account]])]),a("div",null,[a("label",j,o(e.$t("Bank Name")),1),h(a("input",{type:"text",id:"bank_name","onUpdate:modelValue":t[3]||(t[3]=n=>s.myBank.bank_name=n),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:e.$t("Enter bank name"),required:""},null,8,W),[[y,s.myBank.bank_name]])]),a("div",null,[a("label",J,o(e.$t("Country")),1),h(a("input",{type:"text",id:"country","onUpdate:modelValue":t[4]||(t[4]=n=>s.myBank.country=n),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:e.$t("Enter country"),required:""},null,8,P),[[y,s.myBank.country]])]),a("div",null,[a("label",Y,o(e.$t("SWIFT")),1),h(a("input",{type:"text",id:"swift","onUpdate:modelValue":t[5]||(t[5]=n=>s.myBank.swift=n),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:e.$t("Enter SWIFT"),pattern:"[A-Z]{6}[A-Z0-9]{2}([A-Z0-9]{3})?",required:""},null,8,K),[[y,s.myBank.swift]])]),a("div",null,[a("label",G,o(e.$t("Currency")),1),h(a("input",{type:"text",id:"currency","onUpdate:modelValue":t[6]||(t[6]=n=>s.myBank.currency=n),class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:e.$t("Enter currency"),required:""},null,8,H),[[y,s.myBank.currency]])]),s.myBank.id?b("",!0):(d(),f("div",Q,[h(a("input",{id:"favourite-checkbox",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=n=>s.myBank.favourite=n),class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"},null,512),[[U,s.myBank.favourite]]),a("label",X,o(e.$t("Mark this bank account as a favourite"))+".",1)]))]),a("div",ee,[a("div",null,[a("button",{type:"button",class:"mr-3 text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800",onClick:t[8]||(t[8]=(...n)=>l.hideDialog&&l.hideDialog(...n))},o(e.$t("Close")),1),a("button",te,o(s.myBank.id?e.$t("Update"):e.$t("Save")),1)])])],32)]),_:1},8,["visible","header"])]),i(B,{visible:s.deleteBankDialog,"onUpdate:visible":t[12]||(t[12]=n=>s.deleteBankDialog=n),style:{width:"450px"},header:e.$t("Confirm"),modal:!0},{footer:k(()=>[i(r,{label:e.$t("No"),icon:"pi pi-times",text:"",onClick:t[11]||(t[11]=n=>s.deleteBankDialog=!1)},null,8,["label"]),i(r,{label:e.$t("Yes"),icon:"pi pi-check",text:"",onClick:l.deleteMyBank},null,8,["label","onClick"])]),default:k(()=>[a("div",ae,[se,s.myBank?(d(),f("span",ne,[$(o(e.$t("Are you sure you want to delete")),1),a("b",null,o(s.myBank.complete_bank_account),1),$("?")])):b("",!0)])]),_:1},8,["visible","header"]),i(B,{visible:s.deleteBanksDialog,"onUpdate:visible":t[14]||(t[14]=n=>s.deleteBanksDialog=n),style:{width:"450px"},header:e.$t("Confirm"),modal:!0},{footer:k(()=>[i(r,{label:e.$t("No"),icon:"pi pi-times",text:"",onClick:t[13]||(t[13]=n=>s.deleteBanksDialog=!1)},null,8,["label"]),i(r,{label:e.$t("Yes"),icon:"pi pi-check",text:"",onClick:l.deleteSelectedBanks},null,8,["label","onClick"])]),default:k(()=>[a("div",le,[ie,s.myBank?(d(),f("span",re,o(e.$t("Are you sure you want to delete the selected banks?")),1)):b("",!0)])]),_:1},8,["visible","header"])])}const me=I(A,[["render",oe]]);export{me as default};
